# 人工播种墙演示程序 (Artificial Planting Wall Demo)

这是一个基于 Windows Forms 的人工播种墙演示程序，用于模拟种子播种订单管理系统。

## 功能特性

### 主要功能
1. **CSV 订单导入**: 支持导入 CSV 格式的订单数据
2. **播种墙显示**: 3×4 网格布局，共12个格口，用于显示订单信息
3. **二维码扫描**: 通过扫码枪或手动输入二维码进行订单确认
4. **语音播报**: 确认订单时播报格口位置（几行几列）
5. **状态管理**: 格口状态变化（空闲→有订单→确认→清空）

### 界面组件
- **导入按钮**: 选择并导入 CSV 订单数据文件
- **播种墙网格**: 3×4 布局展示订单信息
- **扫码输入框**: 接收扫码枪输入的二维码
- **确认按钮**: 手动确认订单
- **生成测试数据按钮**: 创建示例 CSV 文件用于测试

## 技术规格

- **开发框架**: .NET 9.0 Windows Forms
- **目标平台**: Windows (.NET 9.0-windows)
- **语音合成**: System.Speech 包
- **文件格式**: CSV (UTF-8 编码)

## CSV 数据格式

订单数据 CSV 文件应包含以下列：

```csv
订单编号,产品名称,二维码,数量,客户姓名,订单日期
ORD001,苹果种子,QR001,10,张三,2024-01-15
ORD002,橘子种子,QR002,15,李四,2024-01-16
```

### 字段说明
- **订单编号**: 唯一的订单标识符
- **产品名称**: 种子或产品的名称
- **二维码**: 用于扫码确认的 QR 码内容
- **数量**: 订单数量
- **客户姓名**: 客户名称
- **订单日期**: 订单创建日期 (YYYY-MM-DD 格式)

## 使用说明

### 启动程序
1. 确保系统已安装 .NET 9.0 Runtime
2. 运行 `PlantingWallDemo.exe`

### 操作流程
1. **生成测试数据** (可选):
   - 点击"生成测试CSV文件"按钮
   - 选择保存位置，生成包含12条示例订单的 CSV 文件

2. **导入订单数据**:
   - 点击"导入CSV订单数据"按钮
   - 选择 CSV 文件
   - 系统会自动将订单分配到播种墙的各个格口中

3. **订单确认**:
   - 使用扫码枪扫描订单对应的二维码，或手动在输入框中输入二维码
   - 按回车键或点击"确认"按钮
   - 系统会：
     - 找到匹配的格口并高亮显示
     - 播报语音提示格口位置
     - 2秒后自动清空该格口
     - 显示确认成功消息

## 项目结构

```
PlantingWallDemo/
├── Program.cs              # 程序入口点
├── MainForm.cs            # 主窗体实现
├── PlantingSlot.cs        # 播种墙格口控件
├── OrderData.cs           # 订单数据模型
├── CsvHelper.cs           # CSV文件处理工具
├── PlantingWallDemo.csproj # 项目文件
└── README.md              # 说明文档
```

## 构建说明

### 开发环境要求
- .NET 9.0 SDK
- Windows 操作系统
- Visual Studio 2022 或 VS Code

### 构建命令
```bash
dotnet build
dotnet run
```

### 发布应用
```bash
dotnet publish -c Release -r win-x64 --self-contained
```

## 特性详解

### 播种墙格口
- 每个格口显示完整的订单信息
- 支持状态变化：空闲(灰色) → 有订单(蓝色) → 确认高亮(绿色)
- 自动布局为 3×4 网格

### 语音播报
- 使用 Windows 系统内置的语音合成功能
- 播报格式："X行Y列"
- 如果语音合成失败，会播放系统提示音作为备选

### 错误处理
- 文件导入失败时显示错误信息
- 二维码不匹配时给出提示
- 语音播报失败时使用备选方案

## 测试数据

程序内置了测试数据生成功能，会创建包含12条订单的 CSV 文件，涵盖各种种子类型：
- 苹果种子、橘子种子、梨子种子、葡萄种子
- 桃子种子、香蕉种子、草莓种子、蓝莓种子
- 樱桃种子、柠檬种子、芒果种子、西瓜种子

每条订单都有对应的二维码 (QR001-QR012)，可用于测试扫码确认功能。

## 许可证

本项目仅用于演示目的。